<html>
  <head>
    <meta charset="utf-8">
    <title>D3.js Calendar Heatmap</title>
    <link rel="stylesheet" type="text/css" href="calendar-heatmap/src/calendar-heatmap.css">
    <link rel="stylesheet" type="text/css" href="slick-1.8.0/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="slick-1.8.0/slick/slick-theme.css"/>
    <style>

.heatmap-container {
  padding: 30px;
  display: inline-block;
}

.metrics {
  height: 2em;
  line-height: 2em;
  width: 8em;
  vertical-align: middle;
  text-align: center;
  margin: 0 auto;

}

.slick-prev:before, .slick-next:before{
      color:gray;
}

    </style>
  </head>
  <body>
    <div class="heatmap-container">
      <div class="metrics">
        <div>Questions</div>
        <div>Answers</div>
        <div>Comments</div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="calendar-heatmap/src/calendar-heatmap.js"></script>
    <script type="text/javascript" src="slick-1.8.0/slick/slick.min.js"></script>
    <script type="text/javascript">



d3.csv("community.csv", function(nodes) {

  //setting tag here, eventually tag will be selected on graph
  var tag = 'javascript';

  function getMetricData(activity, metric) {
    return activity.map(function(node) {
      return {
        date: new Date(+node.year, +node.month, +node.day),
        count: +node[metric]
      };
    });
  }


  var metrics = ['questioncount', 'answercount', 'commentcount']
  var metricNames = ['Question', 'Answer', 'Comment']

  activity = nodes.filter(function(node) { return node.tag == tag; });

  var metricData = getMetricData(activity, metrics[0]);
  var metricName = metricNames[0];

  var heatmap = calendarHeatmap()
                  .data(metricData)
                  .selector('.heatmap-container')
                  .tooltipEnabled(true)
                  .tooltipUnit(metricName)
                  .colorRange(['#f4f7f7', '#79a8a9'])
                  .onClick(function (data) {
                    console.log('data', data);
                  });

  heatmap();  // render the chart


  $('.metrics').on('afterChange', function(ev, slick, currentSlide) {
    metricData = getMetricData(activity, metrics[currentSlide]);
    metricName = metricNames[currentSlide];

    heatmap.data(metricData);
    heatmap.tooltipUnit(metricName);
    heatmap();
  });

  $('.metrics').slick();
  

});

    </script>
  </body>
</html>
